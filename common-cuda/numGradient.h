
#ifndef NUM_GRADIENT_H
#define NUM_GRADIENT_H

#include "matlabUtils.h"

#define _GradientMaxPoints_ 30
#define _GradientMaxSize_ _GradientMaxPoints_+10

/** 
    Mathematica code to generate these coeffients
    Reference: http://www.trentfguidry.net/post/2009/07/12/Calculate-derivatives-function-numerically.aspx
    
    For[n = 1, n <= 25, n++,
    A = Table[2 j^i/i!, {j, 1, n}, {i, 1, 2 n - 1, 2}];
    B = Inverse[A];
    Print[B[[1]]];
    ]
    
    For[n = 1, n <= 30, n++, 
    A = Table[2 j^i/i!, {j, 1, n}, {i, 1, 2 n - 1, 2}];
    B = Inverse[A];
    Print[];
    Print[EngineeringForm[N[B[[1]], 200], 40, 
    NumberFormat -> (SequenceForm[#1, "E", #3] &)]];
    ]
**/

namespace Num1ststGradient
{
  const int _n_max = _GradientMaxPoints_;
  
  const double _coefficients[465] = {
    
    // 1 0 
    500.0000000000000000000000000000000000000E-3,
    
    // 2 1 
    666.6666666666666666666666666666666666667E-3,
    -83.33333333333333333333333333333333333333E-3,
      
    // 3 3 
    750.0000000000000000000000000000000000000E-3,
    -150.0000000000000000000000000000000000000E-3,
    16.66666666666666666666666666666666666667E-3,

    // 4 6 
    800.0000000000000000000000000000000000000E-3,
    -200.0000000000000000000000000000000000000E-3,
    38.09523809523809523809523809523809523810E-3,
    -3.571428571428571428571428571428571428571E-3,
    
    // 5 10 
    833.3333333333333333333333333333333333333E-3,
    -238.0952380952380952380952380952380952381E-3,
    59.52380952380952380952380952380952380952E-3,
    -9.920634920634920634920634920634920634921E-3,
    793.6507936507936507936507936507936507937E-6,

    // 6 15 
    857.1428571428571428571428571428571428571E-3,
    -267.8571428571428571428571428571428571429E-3,
    79.36507936507936507936507936507936507937E-3,
    -17.85714285714285714285714285714285714286E-3,
    2.597402597402597402597402597402597402597E-3,
    -180.3751803751803751803751803751803751804E-6,

    // 7 21 
    875.0000000000000000000000000000000000000E-3,
    -291.6666666666666666666666666666666666667E-3,
    97.22222222222222222222222222222222222222E-3,
    -26.51515151515151515151515151515151515152E-3,
    5.303030303030303030303030303030303030303E-3,
    -679.8756798756798756798756798756798756799E-6,
    41.62504162504162504162504162504162504163E-6,

    // 8 28 
    888.8888888888888888888888888888888888889E-3,
    -311.1111111111111111111111111111111111111E-3,
    113.1313131313131313131313131313131313131E-3,
    -35.35353535353535353535353535353535353535E-3,
    8.702408702408702408702408702408702408702E-3,
    -1.554001554001554001554001554001554001554E-3,
    177.6001776001776001776001776001776001776E-6,
    -9.712509712509712509712509712509712509713E-6,

    // 9 36 
    900.0000000000000000000000000000000000000E-3,
    -327.2727272727272727272727272727272727273E-3,
    127.2727272727272727272727272727272727273E-3,
    -44.05594405594405594405594405594405594406E-3,
    12.58741258741258741258741258741258741259E-3,
    -2.797202797202797202797202797202797202797E-3,
    449.5504495504495504495504495504495504496E-6,
    -46.27725215960510078157136980666392431098E-6,
    2.285296402943461766991178755884638237579E-6,

    // 10 45 
    909.0909090909090909090909090909090909091E-3,
    -340.9090909090909090909090909090909090909E-3,
    139.8601398601398601398601398601398601399E-3,
    -52.44755244755244755244755244755244755245E-3,
    16.78321678321678321678321678321678321678E-3,
    -4.370629370629370629370629370629370629371E-3,
    881.4714697067638244108832344126461773521E-6,
    -128.5479226655697243932538050185109008638E-6,
    12.02787580496558824732199345202441177673E-6,
    -541.2544112234514711294897053410985299530E-9,

    // 11 55 
    916.6666666666666666666666666666666666667E-3,
    -352.5641025641025641025641025641025641026E-3,
    151.0989010989010989010989010989010989011E-3,
    -60.43956043956043956043956043956043956044E-3,
    21.15384615384615384615384615384615384615E-3,
    -6.221719457013574660633484162895927601810E-3,
    1.481361775479422538246067657832363714717E-3,
    -272.8824323251567833611177264428038421846E-6,
    36.38432431002090444814903019237384562462E-6,
    -3.118656369430363238412774016489186767825E-6,
    128.8700979103455883641642155574044118936E-9,

    // 12 66 
    923.0769230769230769230769230769230769231E-3,
    -362.6373626373626373626373626373626373626E-3,
    161.1721611721611721611721611721611721612E-3,
    -67.99450549450549450549450549450549450549E-3,
    25.59793148028442146089204912734324499030E-3,
    -8.295625942684766214177978883861236802413E-3,
    2.245432585989861531657197291872214472834E-3,
    -491.1883781852822100500119075970469159324E-6,
    83.16416985147635302434064043971164714199E-6,
    -10.20651175449937059844180587214642942197E-6,
    806.8388738734680314973759582724450135946E-9,
    -30.81676254377829286969144285068366371368E-9,

    // 13 78 
    928.5714285714285714285714285714285714286E-3,
    -371.4285714285714285714285714285714285714E-3,
    170.2380952380952380952380952380952380952E-3,
    -75.10504201680672268907563025210084033613E-3,
    30.04201680672268907563025210084033613445E-3,
    -10.54105852867462774583517617573345127525E-3,
    3.162317558602388323750552852720035382574E-3,
    -790.5793896505970809376382131800088456435E-6,
    159.7130080102216325126541844808098678068E-6,
    -24.99855777551295117589369844047458800454E-6,
    2.840745201762835360897011186417566818698E-6,
    -208.3213147959412597991141536706215667045E-9,
    7.396023010506790288725946284164079291283E-9,

    // 14 91 
    933.3333333333333333333333333333333333333E-3,
    -379.1666666666666666666666666666666666667E-3,
    178.4313725490196078431372549019607843137E-3,
    -81.78104575163398692810457516339869281046E-3,
    34.43412452700378396972824217406260749914E-3,
    -12.91279669762641898864809081527347781218E-3,
    4.216423411469851098334070470293380510099E-3,
    -1.173890608875128998968008255933952528380E-3,
    272.2065180000299128041758274629455138272E-6,
    -51.03872212500560865078296764930228384260E-6,
    7.423814127273543076477522567171241286196E-6,
    -785.2111096154709023197379638354197514246E-9,
    53.68964852071595913297353598874664967006E-9,
    -1.780524058084968032471061142483945014568E-9,

    // 15 105 
    937.5000000000000000000000000000000000000E-3,
    -386.0294117647058823529411764705882352941E-3,
    185.8660130718954248366013071895424836601E-3,
    -88.04179566563467492260061919504643962848E-3,
    38.73839009287925696594427244582043343653E-3,
    -15.37237702098383212934296525627794977640E-3,
    5.390314020344980097302078726227333038479E-3,
    -1.640530354018037420918023960156144837798E-3,
    425.3226843750467387565247304108523653550E-6,
    -91.86969982501009557140934176874411091668E-6,
    16.06113633304372300199464016936085855187E-6,
    -2.181141971154085839777049899542832642846E-6,
    215.7173378064480500878400999547856459958E-9,
    -13.81441079548682094158581920892715959579E-9,
    429.7816691929233181826699309444005207579E-12,

    // 16 120 
    941.1764705882352941176470588235294117647E-3,
    -392.1568627450980392156862745098039215686E-3,
    192.6384588923288613691090471276229790162E-3,
    -93.91124871001031991744066047471620227038E-3,
    42.93085655314757481940144478844169246646E-3,
    -17.88785689714482284141726866185070519436E-3,
    6.666282073470120313571652917459890134544E-3,
    -2.187373805357383227890698613541526450397E-3,
    622.1863268572112292666876056295897458907E-6,
    -150.7605330461704132453896890564005922735E-6,
    30.45667334266068954452316950634355399465E-6,
    -4.985467362637910490918971198955046040791E-6,
    634.7544652695482853159432826255761537347E-9,
    -58.94148606074376935076616195808921427536E-9,
    3.549164752044786111443983945863436558516E-9,
    -103.9794360950620931087104671639678679253E-12,

    // 17 136 
    944.4444444444444444444444444444444444444E-3,
    -397.6608187134502923976608187134502923977E-3,
    198.8304093567251461988304093567251461988E-3,
    -99.41520467836257309941520467836257309942E-3,
    46.99627857522594364699627857522594364700E-3,
    -20.43316459792432332478099068488084506391E-3,
    8.027314663470269877592532054774617703679E-3,
    -2.809560132214594457157386219171116196288E-3,
    864.4800406814136791253496058988049834732E-6,
    -230.5280108483769811000932282396813289262E-6,
    52.39272973826749570456664278174575657413E-6,
    -9.936552191740387116383328803434540039922E-6,
    1.528700337190828787135896738989929236911E-6,
    -183.1622523823112832513056000633094938234E-9,
    16.02669708345223728448924000553958070955E-9,
    -910.6077888325134820732522730420216312245E-12,
    25.20713602304535590514193143368918010310E-12,

    // 18 153 
    947.3684210526315789473684210526315789474E-3,
    -402.6315789473684210526315789473684210526E-3,
    204.5112781954887218045112781954887218045E-3,
    -104.5796308954203691045796308954203691046E-3,
    50.92573330559600582483877678385687539006E-3,
    -22.98731017266486374037861452049095069690E-3,
    9.457636185324972510327201402716276858153E-3,
    -3.501144164759725400457665903890160183066E-3,
    1.152640054241884905500466141198406644631E-3,
    -333.4423014056881333769205622752533507682E-6,
    83.62189376945156949891424759254002527103E-6,
    -17.88579394513269680948999184618217207186E-6,
    3.195476833869861464722777699566045630704E-6,
    -463.6294513427254357298673001602521562406E-9,
    52.45100863675277656741933092722044595853E-9,
    -4.338778287966681885172554948023750125246E-9,
    233.3460591847627232361710224147226958116E-12,
    -6.121733034168157862677326205324515167896E-12,

    // 19 171 
    950.0000000000000000000000000000000000000E-3,
    -407.1428571428571428571428571428571428571E-3,
    209.7402597402597402597402597402597402597E-3,
    -109.4297007340485601355166572557876905703E-3,
    54.71485036702428006775832862789384528515E-3,
    -25.53359683794466403162055335968379446640E-3,
    10.94297007340485601355166572557876905703E-3,
    -4.255599472990777338603425559947299077734E-3,
    1.486082355647573038877386703473659995399E-3,
    -461.1979724423502534447062183194117227101E-6,
    125.7812652115500691212835140871122880118E-6,
    -29.75470789950646796417459473028462727162E-6,
    6.008162172015729108150639320538242045230E-6,
    -1.014365042028629589687770274896066838805E-6,
    139.2265743960864142708704298876954484635E-9,
    -14.91713297100925867187897463082451233537E-9,
    1.169971213412490876225801931829373516500E-9,
    -59.72826014418121590341931784113918853001E-12,
    1.489070197500362723353944212105963148948E-12,

    // 20 190 
    952.3809523809523809523809523809523809524E-3,
    -411.2554112554112554112554112554112554113E-3,
    214.5680406549971767363071710897797854320E-3,
    -113.9892715979672501411631846414455110107E-3,
    58.36250705815923207227555053642010163749E-3,
    -28.05889762411501541936324545020197194110E-3,
    12.47062116627334018638366464453420975160E-3,
    -5.066189848798544450718363761842022711588E-3,
    1.863426151282223246241237245734996859435E-3,
    -614.9306299231336712596082910925489636134E-6,
    180.3315630273119270556036044259674380098E-6,
    -46.49173109297885619402280426606973011190E-6,
    10.40374402080645733013097717842119834672E-6,
    -1.988951062801234489583863284109934978049E-6,
    318.2321700481975183334181254575895964879E-9,
    -41.43648047502571853299715175229031204269E-9,
    4.216112480765732887300187141727472131530E-9,
    -314.3592639167432415969437781112588870000E-12,
    15.27251484615756639337378679083039127126E-12,
    -362.7222275962422018426274362822217926924E-15,

    // 21 210 
    954.5454545454545454545454545454545454545E-3,
    -415.0197628458498023715415019762845849802E-3,
    219.0382081686429512516469038208168642951E-3,
    -118.2806324110671936758893280632411067194E-3,
    61.86986926117360899969595621769534813013E-3,
    -30.55302185736968345663997837910881389142E-3,
    14.02944881205750770968162272510098597055E-3,
    -5.926232687851878256675857875258175108250E-3,
    2.282697035320723476645515626025371152807E-3,
    -795.2621929504455983152118955185164016232E-6,
    248.5194352970142494735037173495363755073E-6,
    -69.03317647139284707597325481931565986313E-6,
    16.86783497491046942127853285177848702538E-6,
    -3.580111913042222081250953911397882960489E-6,
    649.7240138484032665973953394759120928294E-9,
    -98.77561021343968580027969687978393303150E-9,
    12.23227371064268554802225348356457375003E-9,
    -1.184892610147724526019249625188591189462E-9,
    84.18973808944358474347299968445253188281E-12,
    -3.901475667559580756404846326840483184813E-12,
    88.46883599908346386405547226395653480302E-15,

    // 22 231 
    956.5217391304347826086956521739130434783E-3,
    -418.4782608695652173913043478260869565217E-3,
    223.1884057971014492753623188405797101449E-3,
    -122.3244147157190635451505016722408026756E-3,
    65.23968784838350055741360089186176142698E-3,
    -33.00817539947974730583426235600148643627E-3,
    15.60977752881800857812851815850316599942E-3,
    -6.829277668857878752931226694345135124745E-3,
    2.741502146638288244904291719593745999898E-3,
    -1.002361722364624139543131659976463381213E-3,
    331.3592470626856659646716231327151673430E-6,
    -98.27075709457099407285604509573170404045E-6,
    25.91756231065608634888511079447869117550E-6,
    -6.016576964973734330991186434432553308599E-6,
    1.214156072210915756884707893074677424438E-6,
    -209.6815585232667014356814617974360683651E-9,
    30.36113064590287079611677274895001894880E-9,
    -3.584300145696866691208230116195488348122E-9,
    331.2831970348836993157799337176831335876E-12,
    -22.47993122736710816785649550227135549345E-12,
    995.7887586873580583768104319943014615037E-15,
    -21.60285530210177605982749904119868873097E-15,

    // 23 253 
    958.3333333333333333333333333333333333333E-3,
    -421.6666666666666666666666666666666666667E-3,
    227.0512820512820512820512820512820512821E-3,
    -126.1396011396011396011396011396011396011E-3,
    68.47578347578347578347578347578347578348E-3,
    -35.41850869437076333628057765988800471559E-3,
    17.20327565155151362047913772051703086186E-3,
    -7.769221261991006151184126712491562324710E-3,
    3.237175525829585896326719463538150968629E-3,
    -1.236012473498569160415656522441839460749E-3,
    429.6300041572566600375276682284468713835E-6,
    -135.0265727351378074403658385860833024348E-6,
    38.08441795093630466266728780633118786623E-6,
    -9.557865508922238621904917789233695796543E-6,
    2.112791323024915905894771300777974860289E-6,
    -406.3060236586376742105329424573028577478E-9,
    66.92099213201091104644071993414400009964E-9,
    -9.249242814993377949508066982767869932470E-9,
    1.043147685901508791297902291289609390880E-9,
    -92.18514433548217225423322574187245779871E-12,
    5.986048333472868328196962710511198558358E-12,
    -253.9535656624853230144165998398690297485E-15,
    5.280697962735989703513388654515235023126E-15,

    // 24 276 
    960.0000000000000000000000000000000000000E-3,
    -424.6153846153846153846153846153846153846E-3,
    230.6552706552706552706552706552706552707E-3,
    -129.7435897435897435897435897435897435897E-3,
    71.58267020335985853227232537577365163572E-3,
    -37.77974260732881422536594950388053836330E-3,
    18.80282120549083841631116380838294075224E-3,
    -8.740373919739881920082142551553007615299E-3,
    3.766895157328972679362000830298939308950E-3,
    -1.495678959527680328570206212030461196201E-3,
    543.8832580100655740255295316474404349821E-6,
    -180.0354303135170765871544514481110699131E-6,
    53.89834088388037220072815178488148454778E-6,
    -14.48771192931370906899271749104897047055E-6,
    3.467144735220374819929881108968984386115E-6,
    -731.3508425855478135789592964231451439460E-9,
    134.3083326412483789642852079514527667505E-9,
    -21.14112643427057817030415310346941698850E-9,
    2.794665428275670064128333580385186089056E-9,
    -301.6968360070325637411269206097644073412E-12,
    25.54047288948423820030704089818111384899E-12,
    -1.589970150234690718003303929432223490599E-12,
    64.71663886246659721752578436171862496426E-15,
    -1.292085671733274076391573819721812824807E-15,

    // 25 300 
    961.5384615384615384615384615384615384615E-3,
    -427.3504273504273504273504273504273504274E-3,
    234.0252340252340252340252340252340252340E-3,
    -133.1522883247021178055660814281503936676E-3,
    74.56528146183318597111700559976422045388E-3,
    -40.08886100098558385543925032245388196445E-3,
    20.40236675943016321214318989624885064262E-3,
    -9.737493226091668805795613359573315079433E-3,
    4.327774767151852802575828159810362257526E-3,
    -1.780570189913905153059769300036263328811E-3,
    674.4584052704186185832459469834330790949E-6,
    -233.9337711973974487878826032329925544609E-6,
    73.87382248338866803827871681041870140869E-6,
    -21.10680642382533372522249051726248611677E-6,
    5.417413648781835656140439232764038103304E-6,
    -1.238737877008041689666258970906411151670E-6,
    249.8294877999411811091614731239820810091E-9,
    -43.89768777880103440677772654374878942796E-9,
    6.616158684364749204849274574775535248711E-9,
    -838.0467666862015659475747794715677981701E-12,
    86.75432367351983084343424218132171823707E-12,
    -7.047740027636040416681311743937160862586E-12,
    421.3322842608502423016001586049389646111E-15,
    -16.48068458843461832132109463930883705111E-15,
    316.4291440979446717693650170747296713814E-18,

    // 26 325 
    962.9629629629629629629629629629629629630E-3,
    -429.8941798941798941798941798941798941799E-3,
    237.1829958036854588578726509760992519613E-3,
    -136.3802225871191388432767743112570698778E-3,
    77.42877153333215624650552347993949773705E-3,
    -42.34385943229102294730770815309191282495E-3,
    21.99681009469663529730270553407372094803E-3,
    -10.75579317130386946522521998541104737532E-3,
    4.916934021167483184102957707616478800147E-3,
    -2.089696958996180353243757025737003490062E-3,
    821.5024900230684435356292975870283990417E-6,
    -297.2541904688734499635500747847800128112E-6,
    98.49842997785155738437162241389160187825E-6,
    -29.72541904688734499635500747847800128112E-6,
    8.120114471344835706321367896559844252402E-6,
    -1.993778106803419481462835867458890329831E-6,
    436.3946608598455773379668109349144360779E-9,
    -84.30351402974289562210722483969937969687E-9,
    14.19848657343038242056542734142305342263E-9,
    -2.052607298115479197755654170010071853489E-9,
    249.5571183119123644687725434662701341628E-12,
    -24.81391801396855896706545176511208720369E-12,
    1.937555266396835127863140865421351973314E-12,
    -111.4094278178180198521305997617277384655E-15,
    4.194237282553148982668446108676808977526E-15,
    -77.55616276910408621798162183204158612289E-18,

    // 27 351 
    964.2857142857142857142857142857142857143E-3,
    -432.2660098522167487684729064039408866995E-3,
    240.1477832512315270935960591133004926108E-3,
    -139.4406483394247576672493246464325440966E-3,
    80.17837279516923565866836167169871285555E-3,
    -44.54354044176068647703797870649928491975E-3,
    23.58187435152036342902010637402903319281E-3,
    -11.79093717576018171451005318701451659640E-3,
    5.531550773813418582115827421068538650165E-3,
    -2.421922230696685973791254168143522327910E-3,
    984.9922947809488410155818387186574060879E-6,
    -370.4244527381346068776547085779566313493E-6,
    128.2238490247389023807266298923696031594E-6,
    -40.65634237369770075486454118538548392858E-6,
    11.74516557462378021807197856466691757937E-6,
    -3.072863086384128545425808345407042389951E-6,
    723.0266085609714224531313753898923270473E-9,
    -151.7463252535372121197930047114588834544E-9,
    28.12689323921399126247879492363425528559E-9,
    -4.548178481234602842443379604672773195117E-9,
    631.6914557270281725615805006489962770996E-12,
    -73.83406625380848770200291566027229212852E-12,
    7.062388946016464041061148454460827942728E-12,
    -530.8331560731329181189752106294086362181E-15,
    29.39999018251197700351247320409032446747E-15,
    -1.066763069031639223639784949350156911011E-15,
    19.02320973581798341195775629842529470939E-18,

    // 28 378 
    965.5172413793103448275862068965517241379E-3,
    -434.4827586206896551724137931034482758621E-3,
    242.9365962180200222469410456062291434928E-3,
    -142.3456618464961067853170189098998887653E-3,
    82.81929416523409849327535645666902619072E-3,
    -46.68734720098981042513071564959283339183E-3,
    25.15399930828838765762144679896430207233E-3,
    -12.83902048027219786691094680363802918275E-3,
    6.168898729259914891008262728474728736457E-3,
    -2.776004428166961700953718227813627931406E-3,
    1.164757102727396517882678976705018712478E-3,
    -453.7699546042148934251270180079968734029E-6,
    163.4593457486102430349425655863703558975E-6,
    -54.20845649826360100648605491384731190477E-6,
    16.47264724598397798026552986529313664083E-6,
    -4.562736097964312082601957846210456882048E-6,
    1.145157295175356757986373733950859766475E-6,
    -258.6285195625503789172124254212690535396E-9,
    52.13116855684106181981885394829611381538E-9,
    -9.285864399187314136655233359540245273364E-9,
    1.443866184518921537283612572911991490513E-9,
    -192.9530264766195145279009529255115900959E-12,
    21.71338405363493258114486426783250630235E-12,
    -2.000832665198731768294598870833924859591E-12,
    144.9659893276062262311558427170239898270E-15,
    -7.743909686303751401236957410097435354006E-15,
    271.1672078705690726359069261448260191302E-18,
    -4.669333298791686837480540182340754155941E-18,

    // 29 406 
    966.6666666666666666666666666666666666667E-3,
    -436.5591397849462365591397849462365591398E-3,
    245.5645161290322580645161290322580645161E-3,
    -145.1063049853372434017595307917888563050E-3,
    85.35664999137484905985854752458168017940E-3,
    -48.77522856649991374849059858547524581680E-3,
    26.71024421498804800512580398728406318539E-3,
    -13.89654597671675470536950612851941125186E-3,
    6.826373462246826872813090729799009036001E-3,
    -3.150633905652381633606041875291850324308E-3,
    1.360501004713528432693518082512389912769E-3,
    -547.5186970188590034010499600354739892853E-6,
    204.5674252597934737981944905627045674253E-6,
    -70.68110374424757898675158477914044854560E-6,
    22.48944210044241149578459515699923362815E-6,
    -6.559420612629036686270506920791443141543E-6,
    1.744705226888541727294457083791074390589E-6,
    -420.7090618029107711206492258786987892201E-9,
    91.33815157563194373014095035524381608069E-9,
    -17.70841714221435643747630670152686230136E-9,
    3.035728652951032532138795434547462108804E-9,
    -454.5476057894594165769319367236841660242E-12,
    58.52870509329159711776548349117672371883E-12,
    -6.349812345026918555229274152344644554401E-12,
    564.4277640023927604648243690973017381690E-15,
    -39.47047300716033289963806776904207959224E-15,
    2.036175194813826697203551115069631090076E-15,
    -68.89314568918962509335323321664165342362E-18,
    1.146853792685677468854869518469658915494E-18,

    // 30 435 
    967.7419354838709677419354838709677419355E-3,
    -438.5080645161290322580645161290322580645E-3,
    248.0449657869012707722385141739980449658E-3,
    -147.7326634466103156805244091771606003105E-3,
    87.79541141969984474728307745385544247024E-3,
    -50.80752975677074348801104019320338105917E-3,
    28.24820187249029753773586790664589526070E-3,
    -14.96039638641755889334037741108549058214E-3,
    7.501509299172337222871528274504405534067E-3,
    -3.544463143858929337806797109703331614847E-3,
    1.571824010580456469093923330245379873546E-3,
    -651.8079726414988135726785238517547491491E-6,
    251.8613990886650156202120950840411910845E-6,
    -90.35936558213468904556310554151477797023E-6,
    29.98592280058988199437946020933231150420E-6,
    -9.166892160506417729260025199863818054951E-6,
    2.569942232732712855261884411476214323290E-6,
    -657.3579090670480798760144154354668581565E-9,
    152.5126835214633568777863735059729767581E-9,
    -31.87515085598584158745735206274835214244E-9,
    5.952409123433397121840775361857768840793E-9,
    -983.3962625252727762481700554118167053407E-12,
    141.9833816279310981293502294934206235767E-12,
    -17.63836762507477376452576153429067931778E-12,
    1.847218136735103579703061571591169324917E-12,
    -158.5867219037691946860458080006154983617E-15,
    10.71671155165171945896605850036647942145E-15,
    -534.5157855195746774484302577153231731143E-18,
    17.49437988842558850795563672241852582957E-18,
    -281.8538982024122592948408138611873605876E-21
  };

  inline const double *coefficients(const int n_points) {
    const int n = n_points/2;
    insist(2*n+1 == n_points);
    insist(1 <= n && n <= _n_max);
    
    int index = 0;
    for(int i = 0; i < n; i++)
      index += i;
    
    return &_coefficients[index];
  }

  void copy_gradient_coefficients_to_device(const int n_points);

  void gradients_1_3d(const int n1, const int n2, const int n3,
		      const int n1_surface, const int n_points,
		      const double dx1,
		      const double *f, double *vals, double *grads);
  
  void gradients_2_3d(const int n1, const int n2, const int n3,
		      const int n2_surface, const int n_points,
		      const double dx2,
		      const double *f, double *vals, double *grads);
};

#endif /* NUM_GRADIENT_H */
